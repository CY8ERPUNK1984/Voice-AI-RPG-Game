# Анализ предположенных проблем

Пользователь предполагает несколько причин, почему проект не работает:
1. **Нет соединения между фронтендом и бэкендом**.
2. **Неправильно реализовано подключение к внешним API** (OpenAI и т.п.).
3. **Тесты написаны некорректно и не проверяют нужные сценарии**.

Ниже приводится краткий анализ каждой из гипотез на основе исходного кода репозитория.

## 1. Соединение между фронтом и бэком
- Во фронтенде для подключения сокетов используется переменная `VITE_SOCKET_URL`【F:frontend/src/App.tsx†L141-L142】. 
- В файле `.env.example` для фронтенда указано другое название переменной — `VITE_WS_URL`【F:frontend/.env.example†L2-L3】. Если разработчик копирует пример как есть, переменная не будет найдена и приложение попытается использовать значение по умолчанию (`http://localhost:3001`). В продакшене это приведёт к сбоям.
- Кроме того, сервис StoryService на фронте берёт истории из локального JSON-файла, а не из бэкенда【F:frontend/src/services/StoryService.ts†L1-L24】. Это значит, что для большинства данных REST‑API не используется.

## 2. Подключение к внешним API
- Бэкенд использует сервисы `OpenAILLM`, `OpenAITTS` и `WhisperASR`. Все они требуют `OPENAI_API_KEY`【F:backend/src/services/WhisperASR.ts†L19-L25】【F:backend/src/services/OpenAILLM.ts†L19-L25】.
- При отсутствии ключа сервисы выбрасывают ошибку. В README нет явного описания последствий, поэтому при неправильном заполнении `.env` бэкенд может просто упасть.
- Конфигурации повторяют друг друга, но система повторных попыток (retry) реализована. Ошибок в логике подключения не найдено, однако при отсутствии сети или неверном ключе не предусмотрено отдельного graceful fallback.

## 3. Корректность тестов
- В проекте есть unit‑тесты на `vitest` и end‑to‑end тесты на `playwright`. Например, тесты для `OpenAILLM` мокируют библиотеку OpenAI и проверяют работу повторных попыток【F:backend/src/services/__tests__/OpenAILLM.test.ts†L1-L75】【F:backend/src/services/__tests__/OpenAILLM.test.ts†L80-L189】.
- Сами тесты выглядят осмысленными: проверяют успешные ответы, ошибки и повторные попытки. Однако их запуск требует установки зависимостей и, возможно, переменных окружения. При отсутствии сетевого доступа или ключей они не выполнятся.

**Вывод.** Наибольшие проблемы из перечисленных — расхождение переменных окружения и частичное использование API на фронте. Подключение к внешним API реализовано в целом корректно, но требует правильной настройки ключей и окружения. Тесты написаны достаточно подробно, но без настроенной среды могут не работать.
